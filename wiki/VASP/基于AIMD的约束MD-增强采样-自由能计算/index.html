
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ternity.github.io/wiki/VASP/%E5%9F%BA%E4%BA%8EAIMD%E7%9A%84%E7%BA%A6%E6%9D%9FMD-%E5%A2%9E%E5%BC%BA%E9%87%87%E6%A0%B7-%E8%87%AA%E7%94%B1%E8%83%BD%E8%AE%A1%E7%AE%97/">
      
      
        <link rel="prev" href="../../Study_Git/local_hub/">
      
      
        <link rel="next" href="../../%E6%81%92%E7%94%B5%E5%8A%BF%E6%96%B9%E6%B3%95-%E7%94%B5%E8%8D%B7-%E6%9E%81%E5%8C%96%E5%8A%9B%E5%9C%BA%E7%B3%BB%E5%88%97/%E5%8A%9B%E5%9C%BA%E4%B8%8B%E7%9A%84%E6%81%92%E7%94%B5%E5%8A%BF/Dipole-polarization-electric_field-force_field-constant_charge-redox_capacity/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>基于AIMD的约束MD/增强采样/自由能计算 - Qinghan's Personal Homepage</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aimdmd" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="Qinghan&#39;s Personal Homepage" class="md-header__button md-logo" aria-label="Qinghan's Personal Homepage" data-md-component="logo">
      
  <img src="../../../icons/blue_notebook.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Qinghan's Personal Homepage
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              基于AIMD的约束MD/增强采样/自由能计算
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../How_to_edit/howtodo/" class="md-tabs__link">
          
  
  MKDocs

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../Periodic_Table/Periodic_Table/" class="md-tabs__link">
          
  
  Wiki

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Qinghan&#39;s Personal Homepage" class="md-nav__button md-logo" aria-label="Qinghan's Personal Homepage" data-md-component="logo">
      
  <img src="../../../icons/blue_notebook.png" alt="logo">

    </a>
    Qinghan's Personal Homepage
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MKDocs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            MKDocs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../How_to_edit/howtodo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何使用 Mkdocs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Wiki
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Wiki
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Periodic Table
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Periodic Table
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Periodic_Table/Periodic_Table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Periodic Table
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    MSD学习笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            MSD学习笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MSD/MSD_Diffusion-Coefficient_and_calculation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    均方位移mean squre displacement (MSD) 和 扩散系数Diffusion Coefficient的理解与计算
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    RDF学习笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            RDF学习笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RDF/RDF%E3%80%81%E9%85%8D%E4%BD%8D%E6%95%B0%E5%8F%8A%E5%85%B6%E5%9C%A8%E5%A2%9E%E5%BC%BA%E9%87%87%E6%A0%B7%E4%B8%AD%E5%BA%94%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDF、配位数及其在增强采样中应用
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Git学习笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Git学习笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Study_Git/local_hub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    学习如何使用git
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" checked>
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    VASP学习笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            VASP学习笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    基于AIMD的约束MD/增强采样/自由能计算
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    基于AIMD的约束MD/增强采样/自由能计算
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mdconstrained-molecular-dynamic" class="md-nav__link">
    <span class="md-ellipsis">
      约束MD(Constrained molecular dynamic)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slow-growth-approach" class="md-nav__link">
    <span class="md-ellipsis">
      缓慢生长方法(slow-growth approach)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="缓慢生长方法(slow-growth approach)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      理论基础
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vasp" class="md-nav__link">
    <span class="md-ellipsis">
      VASP参数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blue-moon-ensemble" class="md-nav__link">
    <span class="md-ellipsis">
      Blue-moon ensemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadynamics" class="md-nav__link">
    <span class="md-ellipsis">
      MetaDynamics方法
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iconst-file" class="md-nav__link">
    <span class="md-ellipsis">
      ICONST file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ICONST file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    <span class="md-ellipsis">
      flag类型：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      STATUS类型：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tips-incarincrem" class="md-nav__link">
    <span class="md-ellipsis">
      Tips: 可以使用该文件结合INCAR参数INCREM实现盒子指定角度(αβγ)的控制/不变
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tips-incarvalue_max-value_min" class="md-nav__link">
    <span class="md-ellipsis">
      Tips: 可以使用该文件结合INCAR参数VALUE_MAX VALUE_MIN实现指定坐标的上下限
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#increm" class="md-nav__link">
    <span class="md-ellipsis">
      INCREM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lblueout" class="md-nav__link">
    <span class="md-ellipsis">
      LBLUEOUT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      Reference:
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    恒电势方法-电荷-极化力场系列
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            恒电势方法-电荷-极化力场系列
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6_1" >
        
          
          <label class="md-nav__link" for="__nav_3_6_1" id="__nav_3_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    力场下的恒电势
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_1">
            <span class="md-nav__icon md-icon"></span>
            力场下的恒电势
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%81%92%E7%94%B5%E5%8A%BF%E6%96%B9%E6%B3%95-%E7%94%B5%E8%8D%B7-%E6%9E%81%E5%8C%96%E5%8A%9B%E5%9C%BA%E7%B3%BB%E5%88%97/%E5%8A%9B%E5%9C%BA%E4%B8%8B%E7%9A%84%E6%81%92%E7%94%B5%E5%8A%BF/Dipole-polarization-electric_field-force_field-constant_charge-redox_capacity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    偶极、极化、电场、力场、恒电荷、氧化还原能力
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6_2" >
        
          
          <label class="md-nav__link" for="__nav_3_6_2" id="__nav_3_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFT静态-AIMD-Geo-Opt下的恒电势
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_2">
            <span class="md-nav__icon md-icon"></span>
            DFT静态-AIMD-Geo-Opt下的恒电势
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%81%92%E7%94%B5%E5%8A%BF%E6%96%B9%E6%B3%95-%E7%94%B5%E8%8D%B7-%E6%9E%81%E5%8C%96%E5%8A%9B%E5%9C%BA%E7%B3%BB%E5%88%97/DFT%E9%9D%99%E6%80%81-AIMD-Geo-Opt%E4%B8%8B%E7%9A%84%E6%81%92%E7%94%B5%E5%8A%BF/Norskov%E5%85%B3%E4%BA%8E%E8%83%BD%E5%9E%92%E7%9A%84%E6%81%92%E7%94%B5%E5%8A%BF%E6%A0%A1%E6%AD%A3%E6%80%9D%E8%B7%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Norskov关于能垒的恒电势校正思路
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%81%92%E7%94%B5%E5%8A%BF%E6%96%B9%E6%B3%95-%E7%94%B5%E8%8D%B7-%E6%9E%81%E5%8C%96%E5%8A%9B%E5%9C%BA%E7%B3%BB%E5%88%97/DFT%E9%9D%99%E6%80%81-AIMD-Geo-Opt%E4%B8%8B%E7%9A%84%E6%81%92%E7%94%B5%E5%8A%BF/%E6%81%92%E7%94%B5%E5%8A%BF%E6%A8%A1%E6%8B%9F%E5%8F%8A%E9%81%BF%E5%9D%91%E6%8C%87%E5%8D%97_DFT-%E5%9F%BA%E4%BA%8E%E7%94%B5%E5%AD%90%E7%9A%84%E6%81%92%E7%94%B5%E5%8A%BF%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B%E5%92%8C%E6%84%8F%E4%B9%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    恒电势模拟及避坑指南 DFT 基于电子的恒电势数学模型和意义
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/LaTeX_with_Docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use LaTeX by docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/hello-world/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello world!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    归档
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mdconstrained-molecular-dynamic" class="md-nav__link">
    <span class="md-ellipsis">
      约束MD(Constrained molecular dynamic)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slow-growth-approach" class="md-nav__link">
    <span class="md-ellipsis">
      缓慢生长方法(slow-growth approach)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="缓慢生长方法(slow-growth approach)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      理论基础
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vasp" class="md-nav__link">
    <span class="md-ellipsis">
      VASP参数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blue-moon-ensemble" class="md-nav__link">
    <span class="md-ellipsis">
      Blue-moon ensemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadynamics" class="md-nav__link">
    <span class="md-ellipsis">
      MetaDynamics方法
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iconst-file" class="md-nav__link">
    <span class="md-ellipsis">
      ICONST file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ICONST file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    <span class="md-ellipsis">
      flag类型：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      STATUS类型：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tips-incarincrem" class="md-nav__link">
    <span class="md-ellipsis">
      Tips: 可以使用该文件结合INCAR参数INCREM实现盒子指定角度(αβγ)的控制/不变
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tips-incarvalue_max-value_min" class="md-nav__link">
    <span class="md-ellipsis">
      Tips: 可以使用该文件结合INCAR参数VALUE_MAX VALUE_MIN实现指定坐标的上下限
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#increm" class="md-nav__link">
    <span class="md-ellipsis">
      INCREM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lblueout" class="md-nav__link">
    <span class="md-ellipsis">
      LBLUEOUT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      Reference:
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="aimdmd">基于AIMD的约束MD/增强采样/自由能计算</h1>
<hr />
<h2 id="mdconstrained-molecular-dynamic">约束MD(Constrained molecular dynamic)</h2>
<p>约束MD本质上是约束条件下的最优化问题，因此自然想到了利用拉格朗日乘子法。具体而言，使用<a href="http://dx.doi.org/10.1016/0021-9991(77)90098-5">shake</a>算法实现约束的分子动力学，该算法本质使用了拉格朗日乘子法来寻找有约束条件的最小化问题。系统的拉格朗日量扩展可以写为：</p>
<div class="arithmatex">\[ \mathcal{L}^*(q,p)=\mathcal{L}(q,p)+\sum_{i=1}^{r} \lambda_{i}\sigma_{i}(q) \qquad  \]</div>
<p>其中, <span class="arithmatex">\(\lambda_i\)</span>是与几何约束<span class="arithmatex">\(\sigma_i(q)\)</span>相关的拉格朗日乘子,而几何约束定义为：</p>
<div class="arithmatex">\[\sigma_{i}(q)=\xi_{i}(q)-\xi_{i}\]</div>
<p>其中，<span class="arithmatex">\(\xi_i(q)\)</span>是几何参数，<span class="arithmatex">\(\xi_i\)</span>是模拟期间固定的<span class="arithmatex">\(\xi_i(q)\)</span>的值。</p>
<p>shake算法中，拉格朗日乘子<span class="arithmatex">\(\lambda_i\)</span>采用迭代方法确定：</p>
<ol>
<li>标准MD，蛙跳算法计算新位置​<span class="arithmatex">\(q_{i}^{t+\Delta_{t}}\)</span>​</li>
<li>利用新位置​<span class="arithmatex">\(q_{i}^{t+\Delta_{t}}\)</span>计算所有拉格朗日乘子<span class="arithmatex">\(\lambda_i\)</span></li>
<li>通过添加由于恢复力（与<span class="arithmatex">\(\lambda_k\)</span>成正比）的贡献来更新速度和位置</li>
<li>迭代2-4步骤直至<span class="arithmatex">\(|\sigma_{i}(q)|\)</span>小于预定义的容差(SHAKETOL参数)，或迭代次数超过SHAKEMAXITER参数</li>
</ol>
<h2 id="slow-growth-approach">缓慢生长方法(slow-growth approach)</h2>
<h3 id="_1">理论基础</h3>
<p>VASP当中实现了<a href="https://www.vasp.at/wiki/index.php/Slow-growth_approach">近似的缓慢生长方法</a>, 该方法同样定义了一个几何参数​<span class="arithmatex">\(\xi\)</span>​, 其特征值以速度<span class="arithmatex">\(\dot{\xi}\)</span>从初态1线性变化到末态2。执行1→2变换的功为：</p>
<div class="arithmatex">\[ \omega_{1\rightarrow2}^{irrev}=\int_{\xi(1)}^{\xi(2)}(\frac{\partial V(q)}{\partial \xi}) \dot{\xi}dt \qquad  \]</div>
<p>当​​<span class="arithmatex">\(\lim_{\dot{\xi} \to 0}\)</span>​​, 功​<span class="arithmatex">\(\omega_{1\rightarrow2}^{irrev}\)</span>​ 对应于末态2和初态1之间的自由能差。这个功是基于<a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.78.2690">Jarzynski恒等式</a>的、与自由能相关的不可逆功(本来，​​<span class="arithmatex">\(\lim_{\dot{\xi}\to 0}\)</span>，功是可逆功，但是受限于有限的MD轨迹长度，<span class="arithmatex">\(\dot{\xi}\)</span>不可能无限小，因此功是不可逆功):</p>
<div class="arithmatex">\[ exp^{{-{\frac  {\Delta A_{{1\rightarrow 2}}}{k_{B}\,T}}}}={\bigg \langle }exp^{{-{\frac  {w_{{\rightarrow 2}}^{{irrev}}}{k_{B}\,T}}}}{\bigg \rangle}  \]</div>
<p>通过上面公式计算的自由能（将PMF近似视为自由能），需要对​<span class="arithmatex">\(exp^{\{-\frac{w_{{\rightarrow 2}}^{{irrev}}}{k_{B}\,T}\}}\)</span>​在1→2变换的许多实现中取平均值。</p>
<p>基于缓慢增长方法计算的自由能是近似自由能，精度取决于<span class="arithmatex">\(\dot{\xi}\)</span>。而，精度的判断方法可以通过正向（反应物→产物）和逆向(产物→反应物)转变计算得到的自由能分布的滞后性判断；当然，也可以使用Jarzynski恒等式从一系列缓慢增长模拟中计算。Jarzynski恒等式提供了缓慢增长这种非平衡态和从关于状态分布的配分函数得到的自由能这种平衡态之间的桥梁。</p>
<p>关于Jarzynski恒等式的模拟方法的详细说明，请参阅<a href="https://pubs.acs.org/doi/abs/10.1021/jp044556a">参考文献</a>J.P.C.B.和<a href="https://doi.org/10.1103/PhysRevLett.78.2690">参考文献</a>P.R.L.。（著名的热力学第二定律唯一的等式表述形式）</p>
<blockquote>
<p>Note: 该方法最有用的是，在启动任何更准确和耗时的模拟之前，快速测试集体变量的质量。</p>
</blockquote>
<h3 id="vasp">VASP参数</h3>
<p>缓慢生长方法在VASP中仅支持NVT和NVE系综,不允许体积变化,同时仅支持anderson和Nose-Hoover两种控温器.</p>
<p>在<a href="onenote:#基于AIMD的约束MD\增强采样\自由能计算&section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&page-id={A6EFC5DD-E66F-48DC-A7FD-DF96EA8B8395}&object-id={CF448C7A-7973-4317-93FD-5ECB3FD31E99}&D9&base-path=https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one">ICONST file</a>中定义几何约束,且几何约束的STATUS参数设置为0.在INCAR中,需要使用参数<a href="onenote:#基于AIMD的约束MD\增强采样\自由能计算&section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&page-id={A6EFC5DD-E66F-48DC-A7FD-DF96EA8B8395}&object-id={8695ED68-ACC7-4594-81B1-0BCD865C4A1C}&8C&base-path=https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one">INCREM</a>为STATUS=0的集合约束设置<a href="onenote:#基于AIMD的约束MD\增强采样\自由能计算&section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&page-id={A6EFC5DD-E66F-48DC-A7FD-DF96EA8B8395}&object-id={1CB40155-BE60-483F-A2E3-4B1D84E24AFE}&F3&base-path=https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one">变化速度</a><span class="arithmatex">\(\dot{\xi}\)</span>.当需要计算自由能梯度时候,使用LBLUEOUT=.TRUE.</p>
<h2 id="blue-moon-ensemble"><a href="https://www.vasp.at/wiki/index.php/Blue-moon_ensemble">Blue-moon ensemble</a></h2>
<p>简单来说,约束MD产生有偏差的统计平均值,而其正确的平均值可以通过蓝月亮系综平均值(Blue Moon Ensemble Average)获得。进而可以得到自由能梯度和积分得到自由能。且,通过蓝月亮系综平均值,可以从约束MD得到无偏MD的势能平均值(PMF),官方提供了脚本<a href="https://www.vasp.at/wiki/index.php/Blue-moon_ensemble">how to</a> and <a href="https://www.vasp.at/wiki/index.php/Nuclephile_Substitution_CH3Cl_-_SG">Free energy profile</a>.</p>
<p>具体来说，blue moon ensemble average公式：</p>
<div class="arithmatex">\[ a(\xi)=\frac{\left&lt;|\mathbf{Z}|^{-1/2}a(\xi^*)\right&gt;_{\xi^*}}{\left&lt;|\mathbf{Z}|^{-1/2}\right&gt;_{\xi^*}}  \]</div>
<p>其中​<span class="arithmatex">\(\left&lt;\dots\right&gt;_{\xi^∗}\)</span>​表示约束MD得到的括号内量的统计平均值。​<span class="arithmatex">\(\mathbf{Z}\)</span>​是一个质量度量张量，定义:</p>
<div class="arithmatex">\[ \mathbf{Z}_{\alpha , \beta} = \sum_{i=1}^{3N} m_i^{-1} \nabla_i \xi_\alpha \cdot \nabla_i \xi_\beta , 其中\alpha=1,\dots,r,\beta =1, \dots,r  \]</div>
<p>然后可以拿到自由能梯度（基于Blue Moon Ensemble）：</p>
<div class="arithmatex">\[ \left(\frac{\vartheta A}{\vartheta \xi_k}\right)_{\xi^*} = \frac{1}{\left\langle |\mathbf{Z}|^{-1/2} \right\rangle_{\xi^*}} \left\langle |\mathbf{Z}|^{-1/2} \left[ \lambda_k + \frac{k_B T}{2|\mathbf{Z}|} \sum_{j=1}^{r}\left( \mathbf{Z^{-1}} \right)_{kj} \sum_{i=1}^{3N} m_i^{-1} \nabla_i \xi_j \cdot \nabla_i |\mathbf{Z}| \right] \right\rangle_{\xi^*}  \]</div>
<p>其中<span class="arithmatex">\(\lambda_{\xi_k}\)</span>是拉格朗日乘子方法中约束坐标<span class="arithmatex">\(\xi_k\)</span>的对应拉格朗日乘子。</p>
<p>然后自由能就可以通过自由能梯度的积分得到，正如<a href="onenote:https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one#基于AIMD的约束MD/增强采样/自由能计算&amp;section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&amp;page-id={A6EFC5DD-E66F-48DC-A7FD-DF96EA8B8395}&amp;object-id={23C3A93F-9438-4EA4-B9DA-894BDA63D4D8}&amp;E8">缓慢生长方法中</a>提到的那样：</p>
<div class="arithmatex">\[\Delta A_{1 \to 2}=\int_{\xi(1)}^{\xi(2)}\left( \frac{\vartheta A}{\vartheta \xi}\right)_{\xi^*} \cdot d\xi  \]</div>
<p>当设置<code>LBLUEOUT=True</code>时候，REPORT文件将会有<a href="onenote:#基于AIMD的约束MD\增强采样\自由能计算&section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&page-id={A6EFC5DD-E66F-48DC-A7FD-DF96EA8B8395}&object-id={1F96F061-4EE6-41F7-8274-9086418EF1B4}&A7&base-path=https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one">一系列输出</a>,其中第二项为<span class="arithmatex">\(|\mathbf{Z}|^{-1/2}\)</span>，第四项为<span class="arithmatex">\(|\mathbf{Z}|^{-1/2}*(\lambda+GkT)\)</span>。然后自由能梯度即为二者之间的商。</p>
<p>GkT是热力学积分项，通常情况下，它的值很小（10<sup>-13</sup>），可以忽略。因此自由能的梯度基本等于λ，而拉格朗日乘数法中，λ是施加在约束坐标上的<strong>力</strong>。因此可以直接λ对约束坐标的微分进行积分，得到自由能。</p>
<div class="admonition info">
<p class="admonition-title">关于slow-growth方法得到的自由能在不同反应坐标下的讨论</p>
<p>非平衡态的自由能计算方法(基于<a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.78.2690">Jarzynski恒等式</a>)，所观测到的现象（状态）能否和自由能图谱上的能量对应？考虑到这是不可逆功--可逆功平均值--自由能的近似路径，而我们的有限时间模拟明显是不可逆的，因此可以认为自由能与过程是有关的。<font color=Blue><span class="del">这也就解释了C-C耦合过程中CO吸附到表面的自由能变和直接考察CO吸附自由能变的数值差异原因。</span></font>也就是在MD过程中观察到的现象是可以视为必要的、必须经历的过程（比如CO要先吸附）。这也和约束MD方法中拉格朗日乘子λ是能量最小化下的λ相一致，即过程中每一步均为平衡态。同时，我们不能将<span class="underline">C-C耦合过程中CO吸附到表面的自由能变和直接考察CO吸附自由能变的数值差异</span>归因到不可逆功上，因为<span class="underline">C-C耦合过程</span>的<code>反应坐标a</code>和<span class="underline">CO吸附到表面</span>的<code>反应坐标b</code>是不同的，平均力mean force(放在slow-growth语境下称为自由能沿着反应坐标的梯度)是<code>a方向</code>的，而不是<code>b方向</code>的，自由能是F_a * a 而不是F_b * b。
  <br>
  <br>
  我们<font color=Red>不能</font>将“C-C耦合过程中CO吸附到表面的系统自由能沿着C-C距离变化”视为“CO吸附到表面的自由能变化”。换一种说法，使用slow-growth方法研究一个指定反应坐标a下系统自由能变，现在我在MD过程中观察到某个现象，其沿着反应坐标b的自由能变<font color=Red>不能</font>使用反应坐标a的自由能变？</p>
</div>
<h2 id="metadynamics">MetaDynamics方法</h2>
<p>under construction</p>
<h2 id="iconst-file">ICONST file</h2>
<p><a href="https://www.vasp.at/wiki/index.php/ICONST">description</a>：定义和控制几何参数/坐标的<code>文件</code>，例如原子间距、键角、晶格矢量等。在分子动力学模拟中，这些参数/坐标可以被约束或受到偏置势的影响(监视、控制)。输出将会写入REPORT。</p>
<p>两种类型，基本坐标(键长、键角等)和复杂坐标（基本坐标线性组合）。复杂坐标必须在基本坐标之后定义。即：</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>flag<span class="w"> </span>item<span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>...<span class="w"> </span>item<span class="o">(</span>N<span class="o">)</span><span class="w"> </span>status
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>...
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>...
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>flag<span class="w"> </span>c_1<span class="w"> </span>...<span class="w"> </span>c_M<span class="w"> </span>status
</span></code></pre></div>
<p><code>flag</code>指定了基本坐标的类型(键、角等)。<code>item</code>以空格分隔，按在POSCAR中出现顺序（从1开始）指定离子。<code>status</code>指定了status。假设文件前M行指定了M个基本坐标，最后一行指定了一个复杂坐标，其中<code>c_1</code>……<code>c_M</code>是以空格分隔的复杂坐标<code>c_i</code>列表，用于第i行定义的基本坐标。比如：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>R 1 6 0 # 定义原子 1 和 6之间距离
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>R 1 5 0 # 定义原子 1 和 5之间距离
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>S 1 -1 0 # 定义基本坐标1和2之间的线性组合
</span></code></pre></div>
<h4 id="flag">flag类型：</h4>
<p>R：两原子距离</p>
<p>A：三原子构成的角，第二个原子为顶点</p>
<p>T：四个原子构成的二面角(torsional)</p>
<p>M: 原子1到原子2和3构成键的中心的距离（垂直平分线的长度）</p>
<p>B：原子1和2构成键的中间到原子3和4构成键的中心的距</p>
<p>W: 函数 ​​<span class="arithmatex">\(\frac{1-(R/c)^M}{1-(R/c)^N}\)</span>​​，其中 R 是原子1和2之间的键长（Å单位），c 是由item(3)指定的参考键长，指数M和N分别由 item(4) 和 item(5) 定义。其实就是配位数的定义</p>
<p>X、Y 和 Z：与晶格矢量 a、b 和 c 相关联的分数坐标。</p>
<p>cX、cY 和 cZ：笛卡尔坐标 x、y 和 z。</p>
<p>LR：某个晶格矢量 item(1) 的长度。</p>
<p>LA：两个晶格矢量 item(1) 和 item(2) 之间的夹角。</p>
<p>LV：晶胞体积（在这种情况下没有定义 item(i)）。</p>
<p>还有S基本坐标线性组合、C向量模、D坐标数、IS path方法、IZ path方法等</p>
<h4 id="status">STATUS类型：</h4>
<p><code>0</code>：坐标被约束；<code>4</code>：坐标受到费米型阶跃函数影响 <code>5</code>：MetaD中集体变量；<code>7</code>：坐标被监视；<code>8</code>：坐标受谐振势影响</p>
<p>更多使用案例请见<a href="https://www.vasp.at/wiki/index.php/ICONST">官方文档</a></p>
<blockquote>
<h3 id="tips-incarincrem">Tips: 可以使用该文件结合INCAR参数INCREM实现盒子指定角度(αβγ)的控制/不变</h3>
</blockquote>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>ICONST file:
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>LA 1 2 0
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>LA 1 3 0
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>LA 2 3 0
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>INCAR file:
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>INCREM = 0.000000001 0.000000001 0.000000001 #file ICONST to contral lattic and atoms
</span></code></pre></div>
<blockquote>
<h3 id="tips-incarvalue_max-value_min">Tips: 可以使用该文件结合INCAR参数VALUE_MAX VALUE_MIN实现指定坐标的上下限</h3>
</blockquote>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>ICONST file:
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>cZ 1 7 # 1号原子的z坐标受监控
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>INCAR file:
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>VALUE_MAX = 10 # z-axis of atoms 1 must &lt; 10
</span></code></pre></div>
<h2 id="increm">INCREM</h2>
<p>default = 0</p>
<p><a href="https://www.vasp.at/wiki/index.php/INCREM">description</a>: 在 slow-growth approach中控制转换速度的参数。</p>
<p>该参数定义了，在<a href="https://www.vasp.at/wiki/index.php/MDALGO#Slowgro">slow-growth 模拟</a>(MDALGO=1|2), <a href="onenote:#AIMD&amp;section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&amp;page-id={FC2F6A49-6022-4C33-BF5D-992AC8305FAC}&amp;object-id={9296AB25-575C-4C52-9100-401EC18735C7}&amp;14&amp;base-path=https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one">ICONST</a>文件中<code>STATUS=0</code>的受控的结构参数(controlled geometric parameter), 每一时间步长增长的大小。</p>
<p><a href="onenote:#AIMD&amp;section-id={8365C904-43EF-4FFB-9900-552AFAB494A1}&amp;page-id={FC2F6A49-6022-4C33-BF5D-992AC8305FAC}&amp;object-id={9296AB25-575C-4C52-9100-401EC18735C7}&amp;14&amp;base-path=https://njfueducn-my.sharepoint.com/personal/180401224_njfu_edu_cn/Documents/笔记本/各种参考资料/使用方法/VASP.one">ICONST</a>文件中<code>STATUS=0</code>的受控的结构参数都必须提供该参数。</p>
<h2 id="lblueout">LBLUEOUT</h2>
<p>default = .FALSE.</p>
<p><a href="https://www.vasp.at/wiki/index.php/LBLUEOUT">description</a>: 设置为.True.，将自由能梯度输出到REPORT文件,位置位于每个MD步骤之后.</p>
<p>输出如下:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>&gt;Const_coord
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>   cc&gt; R    2.16325   2.16325  0.485234E-05
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>&gt;Blue_moon
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>       lambda         |z|^(-1/2)      GkT           |z|^(-1/2)*(lambda+GkT)
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>b_m&gt; 0.585916E+01 0.215200E+02 -0.117679E+00 0.123556E+03
</span></code></pre></div>
<p>如果有多个约束坐标，那么将按顺序打印各个约束坐标的b_m&gt;。</p>
<p>lambda对Const_coord积分即为自由能。</p>
<h2 id="reference">Reference:</h2>
<p><a href="https://www.vasp.at/wiki/index.php/Constrained_molecular_dynamics">Constrained molecular dynamics - VASP Wiki</a></p>
<p><a href="https://www.vasp.at/wiki/index.php/Slow-growth_approach">Slow-growth approach - VASP Wiki</a></p>
<p><a href="https://www.vasp.at/wiki/index.php/Blue-moon_ensemble">Blue-moon ensemble - VASP Wiki</a></p>
<p><a href="https://www.vasp.at/wiki/index.php/Nuclephile_Substitution_CH3Cl_-_SG">Nuclephile Substitution CH3Cl - SG - VASP Wiki</a></p>
<p><a href="https://wiki.vasp.at/forum/viewtopic.php?t=17582">Free Energy Calculation Using Blue-moon Method - My Community (vasp.at)</a></p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2024 Qinghan Yu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.instant.progress", "content.code.copy", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>